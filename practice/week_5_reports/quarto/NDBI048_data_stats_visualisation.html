<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.256">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ndbi048_data_stats_visualisation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="NDBI048_data_stats_visualisation_files/libs/clipboard/clipboard.min.js"></script>
<script src="NDBI048_data_stats_visualisation_files/libs/quarto-html/quarto.js"></script>
<script src="NDBI048_data_stats_visualisation_files/libs/quarto-html/popper.min.js"></script>
<script src="NDBI048_data_stats_visualisation_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="NDBI048_data_stats_visualisation_files/libs/quarto-html/anchor.min.js"></script>
<link href="NDBI048_data_stats_visualisation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="NDBI048_data_stats_visualisation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="NDBI048_data_stats_visualisation_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="NDBI048_data_stats_visualisation_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="NDBI048_data_stats_visualisation_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="visualisation-python-seaborn" class="level1">
<h1>Visualisation (Python – seaborn)</h1>
<section id="examples-for-the-lecture" class="level2">
<h2 class="anchored" data-anchor-id="examples-for-the-lecture">1. Examples for the lecture</h2>
<p>Here are examples of computations and graphs used for the lecture <strong><em>Tools for EDA &amp; visualisation</em></strong>. Study and run them, they may be useful for your work in the next section.</p>
<p>Complete tutorials to pandas and seaborn can be found at links:</p>
<ul>
<li><a href="https://pandas.pydata.org">Pandas</a></li>
<li><a href="https://seaborn.pydata.org">Seaborn</a></li>
</ul>
<p>First we read packages, setup the environment, read and adjust data.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Setup</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># should enable plotting without explicit call .show()</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Import libraries</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># classes for special types</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas.api.types <span class="im">import</span> CategoricalDtype</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the default theme, set bigger font</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>sns.set_theme()</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading and adjusting data</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> pd.read_csv(<span class="st">"application_train.csv"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> K[<span class="dv">0</span>:<span class="dv">500</span>] <span class="co"># only first 500 records as a sample</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>K.columns <span class="op">=</span> K.columns.<span class="bu">str</span>.lower() <span class="co"># column names to lowercase</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># new columns with more intuitive values</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>K[<span class="st">"age"</span>] <span class="op">=</span> <span class="op">-</span>K[<span class="st">"days_birth"</span>] <span class="op">/</span> <span class="fl">365.25</span> </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>K[<span class="st">"yrs_employed"</span>] <span class="op">=</span> <span class="op">-</span>K[<span class="st">"days_employed"</span>] <span class="op">/</span> <span class="fl">365.25</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>K[<span class="st">"yrs_employed"</span>] <span class="op">=</span> np.where(K[<span class="st">"yrs_employed"</span>] <span class="op">&lt;</span> <span class="dv">0</span>, np.nan, K[<span class="st">"yrs_employed"</span>]) <span class="co"># cleaning from nonsense values</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>K</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sk_id_curr</th>
      <th>target</th>
      <th>name_contract_type</th>
      <th>code_gender</th>
      <th>flag_own_car</th>
      <th>flag_own_realty</th>
      <th>cnt_children</th>
      <th>amt_income_total</th>
      <th>amt_credit</th>
      <th>amt_annuity</th>
      <th>...</th>
      <th>flag_document_20</th>
      <th>flag_document_21</th>
      <th>amt_req_credit_bureau_hour</th>
      <th>amt_req_credit_bureau_day</th>
      <th>amt_req_credit_bureau_week</th>
      <th>amt_req_credit_bureau_mon</th>
      <th>amt_req_credit_bureau_qrt</th>
      <th>amt_req_credit_bureau_year</th>
      <th>age</th>
      <th>yrs_employed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100002</td>
      <td>1</td>
      <td>Cash loans</td>
      <td>M</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>202500.0</td>
      <td>406597.5</td>
      <td>24700.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>25.902806</td>
      <td>1.744011</td>
    </tr>
    <tr>
      <th>1</th>
      <td>100003</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>N</td>
      <td>0</td>
      <td>270000.0</td>
      <td>1293502.5</td>
      <td>35698.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>45.900068</td>
      <td>3.252567</td>
    </tr>
    <tr>
      <th>2</th>
      <td>100004</td>
      <td>0</td>
      <td>Revolving loans</td>
      <td>M</td>
      <td>Y</td>
      <td>Y</td>
      <td>0</td>
      <td>67500.0</td>
      <td>135000.0</td>
      <td>6750.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>52.145106</td>
      <td>0.616016</td>
    </tr>
    <tr>
      <th>3</th>
      <td>100006</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>135000.0</td>
      <td>312682.5</td>
      <td>29686.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>52.032854</td>
      <td>8.320329</td>
    </tr>
    <tr>
      <th>4</th>
      <td>100007</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>M</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>121500.0</td>
      <td>513000.0</td>
      <td>21865.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>54.570842</td>
      <td>8.317591</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>495</th>
      <td>100572</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>31500.0</td>
      <td>314055.0</td>
      <td>13437.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>52.320329</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>496</th>
      <td>100573</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>Y</td>
      <td>N</td>
      <td>1</td>
      <td>157500.0</td>
      <td>961146.0</td>
      <td>26559.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>36.911704</td>
      <td>4.610541</td>
    </tr>
    <tr>
      <th>497</th>
      <td>100574</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>M</td>
      <td>Y</td>
      <td>Y</td>
      <td>0</td>
      <td>225000.0</td>
      <td>1125000.0</td>
      <td>60070.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>50.047912</td>
      <td>0.659822</td>
    </tr>
    <tr>
      <th>498</th>
      <td>100575</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>M</td>
      <td>Y</td>
      <td>Y</td>
      <td>0</td>
      <td>108000.0</td>
      <td>247275.0</td>
      <td>17586.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>61.445585</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>499</th>
      <td>100576</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>2</td>
      <td>180000.0</td>
      <td>225000.0</td>
      <td>24363.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35.052704</td>
      <td>0.936345</td>
    </tr>
  </tbody>
</table>
<p>500 rows × 124 columns</p>
</div>
</div>
</div>
<section id="distributions-of-individual-variables" class="level3">
<h3 class="anchored" data-anchor-id="distributions-of-individual-variables">1.1 Distributions of individual variables</h3>
<p>Basic seaborn method for plotting graph of individual distribution is <a href="https://seaborn.pydata.org/tutorial/distributions.html">displot</a>. It can make plots both for categorial and numeric variables.</p>
<p>Let’s start with some <strong>categorial variables</strong>. We make a frequency table (we combine absolute and relative frequencies). For ordinal (ordered) variable, it may be meaningful to compute cumulative frequencies.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Categorial variable - frequency table</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>freqtab <span class="op">=</span> K.groupby(<span class="st">"name_type_suite"</span>).agg(count<span class="op">=</span>(<span class="st">"sk_id_curr"</span>, <span class="st">"count"</span>)) <span class="co"># absolute frequencies (counts)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>freqtab[<span class="st">"count_rel"</span>] <span class="op">=</span> freqtab[<span class="st">"count"</span>] <span class="op">/</span> <span class="bu">sum</span>(freqtab[<span class="st">"count"</span>]) <span class="co"># relative frequencies</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>freqtab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>count</th>
      <th>count_rel</th>
    </tr>
    <tr>
      <th>name_type_suite</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Children</th>
      <td>7</td>
      <td>0.014028</td>
    </tr>
    <tr>
      <th>Family</th>
      <td>60</td>
      <td>0.120240</td>
    </tr>
    <tr>
      <th>Group of people</th>
      <td>1</td>
      <td>0.002004</td>
    </tr>
    <tr>
      <th>Other_A</th>
      <td>3</td>
      <td>0.006012</td>
    </tr>
    <tr>
      <th>Other_B</th>
      <td>2</td>
      <td>0.004008</td>
    </tr>
    <tr>
      <th>Spouse, partner</th>
      <td>20</td>
      <td>0.040080</td>
    </tr>
    <tr>
      <th>Unaccompanied</th>
      <td>406</td>
      <td>0.813627</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for cumulative frequencies, the variable needs to be ordered</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>cat_type <span class="op">=</span> CategoricalDtype(categories<span class="op">=</span>[<span class="st">"Lower secondary"</span>, <span class="st">"Secondary / secondary special"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Incomplete higher"</span>, <span class="st">"Higher education"</span>],</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                            ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>K[<span class="st">"education"</span>] <span class="op">=</span> K[<span class="st">"name_education_type"</span>].astype(cat_type)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency table</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>freqtab <span class="op">=</span> K.groupby(<span class="st">"education"</span>).agg(count<span class="op">=</span>(<span class="st">"sk_id_curr"</span>, <span class="st">"count"</span>)) <span class="co"># absolute frequencies (counts)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>freqtab[<span class="st">"count_cum"</span>] <span class="op">=</span> freqtab[<span class="st">"count"</span>].cumsum() <span class="co"># cumulative frequencies</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>freqtab[<span class="st">"count_rel"</span>] <span class="op">=</span> freqtab[<span class="st">"count"</span>] <span class="op">/</span> <span class="bu">sum</span>(freqtab[<span class="st">"count"</span>]) <span class="co"># relative frequencies</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>freqtab[<span class="st">"count_relcum"</span>] <span class="op">=</span> freqtab[<span class="st">"count_rel"</span>].cumsum() <span class="co"># cumulative relative frequencies</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>freqtab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>count</th>
      <th>count_cum</th>
      <th>count_rel</th>
      <th>count_relcum</th>
    </tr>
    <tr>
      <th>education</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Lower secondary</th>
      <td>1</td>
      <td>1</td>
      <td>0.002</td>
      <td>0.002</td>
    </tr>
    <tr>
      <th>Secondary / secondary special</th>
      <td>358</td>
      <td>359</td>
      <td>0.716</td>
      <td>0.718</td>
    </tr>
    <tr>
      <th>Incomplete higher</th>
      <td>14</td>
      <td>373</td>
      <td>0.028</td>
      <td>0.746</td>
    </tr>
    <tr>
      <th>Higher education</th>
      <td>127</td>
      <td>500</td>
      <td>0.254</td>
      <td>1.000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The visualisation of frequencies is simple – we use barplot, either standard (bars beside) or stacked (useful for cumulative frequencies). Variable name is assigned either to <em>x</em> or to <em>y</em> parameter, bars are then either vertical or horizontal.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graphs for absolute and relative frequencies</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># done directly from DataFrame, no need to compute frequency table</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, y<span class="op">=</span><span class="st">"name_type_suite"</span>) <span class="co"># absolute freqs</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, y<span class="op">=</span><span class="st">"name_type_suite"</span>, stat<span class="op">=</span><span class="st">'probability'</span>) <span class="co"># relative freqs - difference only at Y scale</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-5-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># frequencies for ordinal variable</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, y<span class="op">=</span><span class="st">"education"</span>, stat<span class="op">=</span><span class="st">"probability"</span>) <span class="co"># relative frequencies directly from DataFrame</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for stacked barplot, we use frequency table computed above</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>freqtab[<span class="st">"hlp"</span>] <span class="op">=</span> [<span class="st">""</span>] <span class="op">*</span> <span class="bu">len</span>(freqtab) <span class="co"># dummy variable, just for filling the seaborn parameter</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># "education" is an alternative name for the index here</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>freqtab, x<span class="op">=</span><span class="st">"hlp"</span>, hue<span class="op">=</span><span class="st">"education"</span>, multiple<span class="op">=</span><span class="st">"stack"</span>, weights<span class="op">=</span><span class="st">"count_rel"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># for stacked absolute frequencies, use "count" instead of "count_rel"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-6-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>If we want to annotate the graph, we may use <em>set</em> methods. For more fine-tuning (colors etc.) see seaborn tutorial.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>freqtab, x<span class="op">=</span><span class="st">"hlp"</span>, hue<span class="op">=</span><span class="st">"education"</span>, multiple<span class="op">=</span><span class="st">"stack"</span>, weights<span class="op">=</span><span class="st">"count_rel"</span>) <span class="op">\</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    .set_axis_labels(<span class="st">"Education"</span>, <span class="st">"Relative frequency"</span>) <span class="op">\</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">set</span>(title<span class="op">=</span><span class="st">"Distribution of education"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Now we treat some <strong>numeric variables</strong>. We make bunch of graphs with different level of detail and smoothing. Many of them use <em>displot</em> method and the parameter <em>kind</em> changes type of graph (ecdf, density etc.) from the default type, which is histogram. Some graphs use <em>catplot</em> method because stripplot and swarmplot are under that method, not under displot.</p>
<p>If the variable is numeric but with few unique values, we can treat it as categorial – note using <em>discrete</em> parameter to adjust bar positions in histogram.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Numerical discrete variable</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># treated as categorial</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"cnt_fam_members"</span>) <span class="co"># not so pretty</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"cnt_fam_members"</span>, discrete<span class="op">=</span><span class="va">True</span>) <span class="co"># better adjusted bars</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-8-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Continuous numeric variable can be plotted many ways depending on required completeness of information.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rug can be displayed via catplot and stripplot or swarmplot</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.stripplot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"ext_source_1"</span>, jitter<span class="op">=</span><span class="va">False</span>, size<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for no overlapping, use</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.catplot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"ext_source_1"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.catplot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"ext_source_1"</span>, kind<span class="op">=</span><span class="st">"swarm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-9-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-9-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-9-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ecdf with rug</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"ext_source_1"</span>, kind<span class="op">=</span><span class="st">"ecdf"</span>, rug<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-10-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"ext_source_1"</span>, bins<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for less smoothing, use bigger number of bins:</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"ext_source_1"</span>, bins<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># density with rug</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"ext_source_1"</span>, kind<span class="op">=</span><span class="st">"kde"</span>, rug<span class="op">=</span><span class="va">True</span>, fill<span class="op">=</span><span class="va">True</span>, bw_adjust<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for less smoothing, use bigger number of bins:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"ext_source_1"</span>, kind<span class="op">=</span><span class="st">"kde"</span>, rug<span class="op">=</span><span class="va">True</span>, fill<span class="op">=</span><span class="va">True</span>, bw_adjust<span class="op">=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>For numeric variable, information of distribution can be usually “compressed” into few numbers (statistics).</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># computing statistical characteristics of distribution</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Min and max age: "</span>, <span class="st">"</span><span class="sc">%.1f</span><span class="st">"</span> <span class="op">%</span> K[<span class="st">"age"</span>].<span class="bu">min</span>(), <span class="st">"--"</span>, <span class="st">"</span><span class="sc">%.1f</span><span class="st">"</span> <span class="op">%</span> K[<span class="st">"age"</span>].<span class="bu">max</span>())</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean age: "</span>, <span class="st">"</span><span class="sc">%.1f</span><span class="st">"</span> <span class="op">%</span> K[<span class="st">"age"</span>].mean())</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Median age: "</span>, <span class="st">"</span><span class="sc">%.1f</span><span class="st">"</span> <span class="op">%</span> K[<span class="st">"age"</span>].median())</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Std. dev. of age: "</span>, <span class="st">"</span><span class="sc">%.1f</span><span class="st">"</span> <span class="op">%</span> K[<span class="st">"age"</span>].std())</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Decils of age:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>hlp_10s <span class="op">=</span> [i<span class="op">/</span><span class="fl">10.0</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">11</span>)]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(K[<span class="st">"age"</span>].quantile(hlp_10s))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Min and max age:  21.2 -- 68.7
Mean age:  43.6
Median age:  43.3
Std. dev. of age:  11.8
Decils of age:

0.0    21.210130
0.1    27.922793
0.2    31.980835
0.3    36.217385
0.4    39.310609
0.5    43.278576
0.6    46.818891
0.7    50.967283
0.8    55.100342
0.9    60.133060
1.0    68.731006
Name: age, dtype: float64</code></pre>
</div>
</div>
<p>For a skewed distribution, quantiles are more useful than mean or standard deviation. They can be plotted as ECDF (quantiles can be calculated from Y axis) or boxplot.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles for skewed distribution - ecdf, boxplot</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"yrs_employed"</span>, kind<span class="op">=</span><span class="st">"ecdf"</span>) <span class="op">\</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    .refline(y<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.catplot(data<span class="op">=</span>K, y<span class="op">=</span><span class="st">"yrs_employed"</span>, kind<span class="op">=</span><span class="st">"box"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-14-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-14-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="relationships-of-variables" class="level3">
<h3 class="anchored" data-anchor-id="relationships-of-variables">1.2 Relationships of variables</h3>
<p>Method for analysis and plotting are different depending on type (categorial or numeric) of both variables.</p>
<ul>
<li>If one of variables is categorial, the basic strategy is to split the data into categories by this variable and to study distribution of the other variable for each category (and to compare distributions among various categories).</li>
<li>If both variables are numeric, then we use bivariate plots and compute statistics like correlation.</li>
</ul>
<p>Let’s start with the case of both variables categorial. In this case we usually compute a contingency table (2-D frequency table).</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># contingency table with absolute frequencies</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>pd.crosstab(K[<span class="st">"name_family_status"</span>], K[<span class="st">"code_gender"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>code_gender</th>
      <th>F</th>
      <th>M</th>
    </tr>
    <tr>
      <th>name_family_status</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Civil marriage</th>
      <td>36</td>
      <td>18</td>
    </tr>
    <tr>
      <th>Married</th>
      <td>176</td>
      <td>128</td>
    </tr>
    <tr>
      <th>Separated</th>
      <td>26</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Single / not married</th>
      <td>44</td>
      <td>34</td>
    </tr>
    <tr>
      <th>Widow</th>
      <td>28</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for relative frequencies in contingency table, use parameter normalize:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>pd.crosstab(K[<span class="st">"name_family_status"</span>], K[<span class="st">"code_gender"</span>], normalize<span class="op">=</span><span class="st">"columns"</span>) <span class="co"># relative by columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>code_gender</th>
      <th>F</th>
      <th>M</th>
    </tr>
    <tr>
      <th>name_family_status</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Civil marriage</th>
      <td>0.116129</td>
      <td>0.094737</td>
    </tr>
    <tr>
      <th>Married</th>
      <td>0.567742</td>
      <td>0.673684</td>
    </tr>
    <tr>
      <th>Separated</th>
      <td>0.083871</td>
      <td>0.031579</td>
    </tr>
    <tr>
      <th>Single / not married</th>
      <td>0.141935</td>
      <td>0.178947</td>
    </tr>
    <tr>
      <th>Widow</th>
      <td>0.090323</td>
      <td>0.021053</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Visualisation of contingency table, similarly to frequency table, can be done by some kind of barplot. Bars can be:</p>
<ul>
<li>put beside one by one</li>
<li>stacked within each category as absolute counts</li>
<li>stacked within each category as relative counts (all stacked bars sum up to 1)</li>
</ul>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># barplot with bars beside</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"code_gender"</span>, hue<span class="op">=</span><span class="st">"name_family_status"</span>, multiple<span class="op">=</span><span class="st">"dodge"</span>)<span class="op">\</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    .refline(x<span class="op">=</span><span class="fl">0.5</span>) <span class="co"># auxiliary line to split categories</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># barplot with stacked bars as absolute counts</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"code_gender"</span>, hue<span class="op">=</span><span class="st">"name_family_status"</span>, multiple<span class="op">=</span><span class="st">"stack"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># barplot stacked as relative counts (sums up to 1)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># needs data preparation</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>hlp_df <span class="op">=</span> pd.crosstab(K[<span class="st">"name_family_status"</span>], K[<span class="st">"code_gender"</span>], normalize<span class="op">=</span><span class="st">"columns"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(hlp_df)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for plotting stacked barplot, we need to transform this "wide" format to "long" format</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>hlp_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>hlp_df <span class="op">=</span> pd.melt(hlp_df, id_vars<span class="op">=</span><span class="st">"name_family_status"</span>, var_name<span class="op">=</span><span class="st">"code_gender"</span>, value_name<span class="op">=</span><span class="st">"prop"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(hlp_df)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>hlp_df, x<span class="op">=</span><span class="st">"code_gender"</span>, hue<span class="op">=</span><span class="st">"name_family_status"</span>, multiple<span class="op">=</span><span class="st">"stack"</span>, weights<span class="op">=</span><span class="st">"prop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Another idea is to make <em>heatmap</em> – replace each cell in a contingency table by color tone according to the value in the cell. This is good for plotting absolute frequencies but may be confusing for relative ones.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># discrete heatmap</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"code_gender"</span>, y<span class="op">=</span><span class="st">"name_family_status"</span>, cbar<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Having one categorial and one numeric variable, we can split the data by categorial variable and compute statistics by categories. There are many ways how to do splitting by categories when plotting:</p>
<ul>
<li>multiple lines (curves), possibly overlapping</li>
<li>use one axis for categories (sections inside one graph), distribution graph in each section separately</li>
<li>split figure to separate graphs</li>
</ul>
<p>We can either use <em>displot</em> with parameters <em>hue</em> or <em>col</em> or <em>catplot</em> with category variable as <em>x</em> (or <em>y</em>, if we want split the graph horizontally).</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># numeric vs. category as overlapping lines/curves</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"ext_source_1"</span>, hue<span class="op">=</span><span class="st">"code_gender"</span>) <span class="co"># overlapping histograms</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"ext_source_1"</span>, hue<span class="op">=</span><span class="st">"code_gender"</span>, kind<span class="op">=</span><span class="st">"kde"</span>) <span class="co"># overlapping KDE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-21-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># numeric vs. category as separate graphs</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"ext_source_1"</span>, col<span class="op">=</span><span class="st">"code_gender"</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                stat<span class="op">=</span><span class="st">"probability"</span>, common_norm<span class="op">=</span><span class="va">False</span>) <span class="co"># separate histograms</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># numeric vs. category as sections of one graph</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.catplot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"code_gender"</span>, y<span class="op">=</span><span class="st">"ext_source_1"</span>) <span class="co"># stripplot</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.catplot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"code_gender"</span>, y<span class="op">=</span><span class="st">"ext_source_1"</span>, kind<span class="op">=</span><span class="st">"violin"</span>) <span class="co"># violinplot</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.catplot(data<span class="op">=</span>K.assign(temp<span class="op">=</span><span class="st">""</span>), x<span class="op">=</span><span class="st">"temp"</span>, y<span class="op">=</span><span class="st">"ext_source_1"</span>, hue<span class="op">=</span><span class="st">"code_gender"</span>, kind<span class="op">=</span><span class="st">"violin"</span>, split<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-23-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-23-output-3.png" class="img-fluid"></p>
</div>
</div>
<p>We may want to compute statistics like mean, median or SD by categories and compare them. Computing is easy by pandas <em>groupby</em> and <em>agg</em> methods. For plotting by seaborn we can use <em>barplot</em>, which is a special functionality of <em>catplot</em> method.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># statistics by categories</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>K.groupby(<span class="st">"code_gender"</span>).agg({<span class="st">"ext_source_1"</span>: [<span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"std"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">ext_source_1</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>median</th>
      <th>std</th>
    </tr>
    <tr>
      <th>code_gender</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>F</th>
      <td>0.555957</td>
      <td>0.571107</td>
      <td>0.181368</td>
    </tr>
    <tr>
      <th>M</th>
      <td>0.427220</td>
      <td>0.405098</td>
      <td>0.230805</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># barplots with estimator by categories</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.catplot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"code_gender"</span>, y<span class="op">=</span><span class="st">"ext_source_1"</span>, kind<span class="op">=</span><span class="st">"bar"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.catplot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"code_gender"</span>, y<span class="op">=</span><span class="st">"yrs_employed"</span>, kind<span class="op">=</span><span class="st">"box"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-25-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-25-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>When both variables are numeric, we use <em>relplot</em> or <em>displot</em> method with two basic cases:</p>
<ul>
<li>for each x value there can be more observations – <em>scatterplot</em> (a cloud of points), heatmap, contourplot</li>
<li>for each x value there is only one observation or we want to aggregate over y axis – <em>lineplot</em> (time series)</li>
</ul>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.relplot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"age"</span>, y<span class="op">=</span><span class="st">"ext_source_1"</span>) <span class="co"># scatterplot</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"age"</span>, y<span class="op">=</span><span class="st">"ext_source_1"</span>, cbar<span class="op">=</span><span class="va">True</span>) <span class="co"># heatmap</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.displot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"age"</span>, y<span class="op">=</span><span class="st">"ext_source_1"</span>, kind<span class="op">=</span><span class="st">"kde"</span>) <span class="co"># contourplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-26-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-26-output-3.png" class="img-fluid"></p>
</div>
</div>
<p>Scatterplot or contourplot can be combined with graphs of individual distributions (histogram, density). It does method <em>jointplot</em>.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># jointplot - both scatterplot and individual distributions</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.jointplot(data<span class="op">=</span>K, x<span class="op">=</span><span class="st">"age"</span>, y<span class="op">=</span><span class="st">"ext_source_1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-27-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lineplot</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># try yourself :-)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="tasks-for-you" class="level2">
<h2 class="anchored" data-anchor-id="tasks-for-you">2. Tasks for you</h2>
<p>We will use the same data as above (file <em>application_train.csv</em> from <em>kaggle_home_credit.zip</em>) but bigger volume of it.</p>
<ol type="1">
<li>Read file <em>application_train.csv</em> again and make from it a random sample of 5 000 records.</li>
<li>Transform data as above: <em>data_birth</em> -&gt; <em>age</em>, <em>days_employed</em> -&gt; <em>years_employed</em>.</li>
<li>Explore distribution of <em>age</em> by ECDF, density estimation, histogram, boxplot:
<ul>
<li>In histogram use bins of 5 years, try to make reasonable boundaries of them (e. g. 20-25 etc., see parameter <em>bins</em>).</li>
<li>In density estimation, limit the curve to the variable range (see parameter <em>cut</em> in <em>kdeplot</em>). Try various amount of smoothing.</li>
<li>For one graph (no matter which one) do a neat annotation (proper title, axis labels), try to change theme (<em>set_theme</em> method), font size (<em>font_scale</em> in <em>set</em> method), color (find yourself).</li>
</ul></li>
<li>Is distribution of <em>age</em> more likely Gaussian-like, or skewed? Does 1-sigma and 2-sigma rule hold for it?</li>
<li>Explore distribution of <em>cnt_children</em>, consider it like a categorial ordered variable – make frequency table(s) and graphs.</li>
<li>Explore relationship of <em>flag_own_car</em>, <em>name_family_status</em>, <em>yrs_employed</em> and <em>ext_source_1</em> to answer following questions:
<ul>
<li>What is share of car owners in groups by family status? (Compute owner shares as decimal numbers and plot them as by categories.)</li>
<li>Plot <em>ext_source_1</em> and <em>yrs_employed</em> first together and then with distinction of car ownership as a category. (Hint: making some axis in log scale may help.)</li>
<li>What are distributions of <em>ext_source_1</em> in groups by family status (make a plot)? What statistics do describe well them distribution? Compute them for each group.</li>
<li>Do the same for <em>yrs_employed</em> instead of <em>ext_source_1</em>. Do we use same or different statistics to describe distribution of <em>yrs_employed</em>? Again, compute them.</li>
</ul></li>
<li>Make a plot of <em>age</em> distribution for grouping by <em>code_gender</em> and <em>cnt_children</em> (together, i. e. nested grouping).</li>
</ol>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">"application_train.csv"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.sample(n<span class="op">=</span><span class="dv">5000</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>data.columns <span class="op">=</span> data.columns.<span class="bu">str</span>.lower() <span class="co"># column names to lowercase</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sk_id_curr</th>
      <th>target</th>
      <th>name_contract_type</th>
      <th>code_gender</th>
      <th>flag_own_car</th>
      <th>flag_own_realty</th>
      <th>cnt_children</th>
      <th>amt_income_total</th>
      <th>amt_credit</th>
      <th>amt_annuity</th>
      <th>...</th>
      <th>flag_document_18</th>
      <th>flag_document_19</th>
      <th>flag_document_20</th>
      <th>flag_document_21</th>
      <th>amt_req_credit_bureau_hour</th>
      <th>amt_req_credit_bureau_day</th>
      <th>amt_req_credit_bureau_week</th>
      <th>amt_req_credit_bureau_mon</th>
      <th>amt_req_credit_bureau_qrt</th>
      <th>amt_req_credit_bureau_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>213114</th>
      <td>346965</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>112500.0</td>
      <td>490005.0</td>
      <td>23701.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>10863</th>
      <td>112643</td>
      <td>0</td>
      <td>Revolving loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>1</td>
      <td>135000.0</td>
      <td>202500.0</td>
      <td>10125.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>285321</th>
      <td>430441</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>M</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>69750.0</td>
      <td>454500.0</td>
      <td>14661.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>271043</th>
      <td>414210</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>49500.0</td>
      <td>350860.5</td>
      <td>17010.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>146981</th>
      <td>270413</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>N</td>
      <td>0</td>
      <td>135000.0</td>
      <td>497520.0</td>
      <td>25402.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>227100</th>
      <td>363046</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>M</td>
      <td>Y</td>
      <td>N</td>
      <td>0</td>
      <td>401161.5</td>
      <td>1575000.0</td>
      <td>56776.5</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>93072</th>
      <td>208073</td>
      <td>0</td>
      <td>Revolving loans</td>
      <td>F</td>
      <td>Y</td>
      <td>N</td>
      <td>0</td>
      <td>360000.0</td>
      <td>675000.0</td>
      <td>33750.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>284040</th>
      <td>428946</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>M</td>
      <td>Y</td>
      <td>Y</td>
      <td>1</td>
      <td>81000.0</td>
      <td>450000.0</td>
      <td>17095.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>112911</th>
      <td>230967</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>112500.0</td>
      <td>640080.0</td>
      <td>29839.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>17013</th>
      <td>119848</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>202500.0</td>
      <td>840951.0</td>
      <td>33480.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5000 rows × 122 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># new columns with more intuitive values</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"age"</span>] <span class="op">=</span> <span class="op">-</span>data[<span class="st">"days_birth"</span>] <span class="op">/</span> <span class="fl">365.25</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"yrs_employed"</span>] <span class="op">=</span> <span class="op">-</span>data[<span class="st">"days_employed"</span>] <span class="op">/</span> <span class="fl">365.25</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sk_id_curr</th>
      <th>target</th>
      <th>name_contract_type</th>
      <th>code_gender</th>
      <th>flag_own_car</th>
      <th>flag_own_realty</th>
      <th>cnt_children</th>
      <th>amt_income_total</th>
      <th>amt_credit</th>
      <th>amt_annuity</th>
      <th>...</th>
      <th>flag_document_20</th>
      <th>flag_document_21</th>
      <th>amt_req_credit_bureau_hour</th>
      <th>amt_req_credit_bureau_day</th>
      <th>amt_req_credit_bureau_week</th>
      <th>amt_req_credit_bureau_mon</th>
      <th>amt_req_credit_bureau_qrt</th>
      <th>amt_req_credit_bureau_year</th>
      <th>age</th>
      <th>yrs_employed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>213114</th>
      <td>346965</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>112500.0</td>
      <td>490005.0</td>
      <td>23701.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>63.942505</td>
      <td>-999.980835</td>
    </tr>
    <tr>
      <th>10863</th>
      <td>112643</td>
      <td>0</td>
      <td>Revolving loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>1</td>
      <td>135000.0</td>
      <td>202500.0</td>
      <td>10125.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>53.316906</td>
      <td>25.837098</td>
    </tr>
    <tr>
      <th>285321</th>
      <td>430441</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>M</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>69750.0</td>
      <td>454500.0</td>
      <td>14661.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>54.349076</td>
      <td>6.469541</td>
    </tr>
    <tr>
      <th>271043</th>
      <td>414210</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>49500.0</td>
      <td>350860.5</td>
      <td>17010.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>63.737166</td>
      <td>-999.980835</td>
    </tr>
    <tr>
      <th>146981</th>
      <td>270413</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>N</td>
      <td>0</td>
      <td>135000.0</td>
      <td>497520.0</td>
      <td>25402.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>67.915127</td>
      <td>-999.980835</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>227100</th>
      <td>363046</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>M</td>
      <td>Y</td>
      <td>N</td>
      <td>0</td>
      <td>401161.5</td>
      <td>1575000.0</td>
      <td>56776.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>26.151951</td>
      <td>1.902806</td>
    </tr>
    <tr>
      <th>93072</th>
      <td>208073</td>
      <td>0</td>
      <td>Revolving loans</td>
      <td>F</td>
      <td>Y</td>
      <td>N</td>
      <td>0</td>
      <td>360000.0</td>
      <td>675000.0</td>
      <td>33750.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>44.454483</td>
      <td>9.774127</td>
    </tr>
    <tr>
      <th>284040</th>
      <td>428946</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>M</td>
      <td>Y</td>
      <td>Y</td>
      <td>1</td>
      <td>81000.0</td>
      <td>450000.0</td>
      <td>17095.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>28.391513</td>
      <td>1.396304</td>
    </tr>
    <tr>
      <th>112911</th>
      <td>230967</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>112500.0</td>
      <td>640080.0</td>
      <td>29839.5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>31.118412</td>
      <td>8.561259</td>
    </tr>
    <tr>
      <th>17013</th>
      <td>119848</td>
      <td>0</td>
      <td>Cash loans</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>202500.0</td>
      <td>840951.0</td>
      <td>33480.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>52.476386</td>
      <td>0.416153</td>
    </tr>
  </tbody>
</table>
<p>5000 rows × 124 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>bin_ranges <span class="op">=</span> [i <span class="op">*</span> <span class="dv">5</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">20</span>)]</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(data, x<span class="op">=</span><span class="st">"age"</span>, bins<span class="op">=</span>bin_ranges, kde<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>&lt;AxesSubplot: xlabel='age', ylabel='Count'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-31-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>sns.ecdfplot(data, x<span class="op">=</span><span class="st">"age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>&lt;AxesSubplot: xlabel='age', ylabel='Proportion'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-32-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sns.kdeplot(data, x<span class="op">=</span><span class="st">"age"</span>, cut<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>&lt;AxesSubplot: xlabel='age', ylabel='Density'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-33-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data, x<span class="op">=</span><span class="st">"age"</span>,palette<span class="op">=</span>[<span class="st">"red"</span>]).set_title(<span class="st">"Average age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>Text(0.5, 1.0, 'Average age')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="NDBI048_data_stats_visualisation_files/figure-html/cell-34-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>